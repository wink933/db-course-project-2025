# 数据库课程讨论课汇报准备：个人多媒体资产管理系统 (MVP版)

> **文档说明**：本文档基于最新的 MVP (最小可行性产品) 设计方案更新，严格对标《第二次小班讨论课》的考核要求（需求分析、数据库设计、系统设计）。

---

## 🗣️ 第一部分：汇报演讲稿 (Presentation Script)

### 1. 选题与场景 (Scenario & User)
*   **开场**：
    "老师、同学们好。我们的项目是**《MediArchive Pro - 个人多媒体资产管理系统》**。
    我们选择了一个非常贴近生活的场景：**'单用户、多设备'的数字资产管理**。"
*   **痛点**：
    "大家可能都有这样的困扰：台式机里存着电影，笔记本里存着课件，手机里存着照片，浏览器里还收藏了一堆 B 站链接。
    **痛点在于**：资源是分散的，我想找一个资料，得回忆它到底在哪台设备上，或者哪个网页里。"
*   **解决方案 (MVP)**：
    "我们不打算做一个庞大的企业级系统，而是做一个**'小而美'的 MVP 工具**。
    核心理念是：**本地优先，分布式索引**。
    1.  **统一索引**：无论文件在本地硬盘还是网络 URL，都作为一条'资产记录'存入数据库。
    2.  **虚拟整理**：通过'虚拟文件夹'整理资源，不改变物理文件位置。
    3.  **多机同步**：在局域网内，让台式机和笔记本共享同一套数据库索引。"

### 2. 数据库设计核心 (Database Design) —— *重点汇报部分*

"为了实现上述功能，我们在数据库设计上做了几个关键决策："

#### **(1) 核心设计：逻辑与物理分离 (1:N 关系)**
"这是我们 E-R 图中最核心的部分。我们没有把文件路径直接写在媒体表里，而是拆分成了两个实体：
*   **MediaItem (媒体项)**：代表'资源本身'（如《数据库概论》这本书）。
*   **StorageLocation (存储位置)**：代表'它在哪里'。
*   **关系**：**1对多**。
*   **意义**：这意味着同一本书，可以同时有一条'台式机D盘'的记录，和一条'笔记本C盘'的记录。这是实现多设备管理的基础。"

#### **(2) 虚拟文件夹设计 (Virtual Folders)**
"我们设计了 `Folders` 表，并使用 `parent_id` 实现自关联。
*   **设计理由**：物理文件夹结构往往很乱（下载目录、文档目录），我们希望用户在软件里能有一套整洁的、逻辑上的目录树，这与物理路径解耦，互不影响。"

#### **(3) 规范化与索引**
"我们的设计完全符合 **3NF (第三范式)**。
*   例如，设备信息独立在 `Devices` 表，存储位置只存 `device_id`，消除了传递依赖。
*   我们在 `title` (标题) 和 `tag_name` (标签) 上建立了索引，确保在几万条记录下搜索依然流畅。"

### 3. 系统架构 (System Architecture)

"技术上，我们选择了 **Local-First (本地优先)** 架构：
*   **客户端**：Electron + React，提供原生桌面体验。
*   **数据库**：**SQLite**。每个设备都有完整的数据库副本，断网也能用。
*   **同步**：利用局域网 P2P 通信同步元数据，不依赖云服务器，保护隐私且零成本。"

---

## 🛡️ 第二部分：设计答辩与 Q&A (Defense Preparation)

### Q1: 为什么选择 SQLite？对于多设备同步，用 MySQL/PostgreSQL 不是更好吗？
*   **回答**：
    *   **场景适配**：我们的定位是**个人桌面应用**，不是 Web 服务。用户不想在自己电脑上安装配置庞大的 MySQL 服务。
    *   **便携性**：SQLite 是单文件数据库，备份和迁移只需复制 `.db` 文件，非常符合“个人资产”的概念。
    *   **同步策略**：我们通过应用层的 P2P 协议来同步不同设备上的 SQLite 数据，而不是依赖数据库本身的主从复制。

### Q2: 你的 E-R 图里，MediaItem 和 StorageLocation 分开有什么具体好处？
*   **回答**：
    *   **灵活性**：如果我把一个文件从 D 盘移动到 E 盘，我只需要更新 `StorageLocation`，而不需要修改 `MediaItem` 的标题、标签、备注等信息。
    *   **混合管理**：同一个视频，我可以同时存一个本地高清版路径，和一个 B 站在线观看链接。它们属于同一个 `MediaItem`，用户体验非常统一。

### Q3: 既然是 MVP，为什么还要做“虚拟文件夹”？直接读取硬盘文件夹不行吗？
*   **回答**：
    *   **直接读取的弊端**：硬盘文件夹通常是按“来源”分类的（如 Downloads, Wechat Files），而用户管理资源是按“主题”分类的（如“数据库课程”、“旅游照片”）。
    *   **价值**：虚拟文件夹让用户拥有了**二次整理**的能力，而且不会因为整理文件而破坏其他软件的路径依赖。

### Q4: 如果两台设备同时修改了同一个文件的备注，同步时怎么处理？(并发冲突)
*   **回答**：
    *   在 MVP 阶段，我们采用 **LWW (Last Write Wins, 最后写入胜出)** 策略。
    *   我们在 `media_items` 表中有 `updated_at` 字段。同步时，比较两边记录的时间戳，保留较新的那个。对于个人使用场景，这种冲突概率很低，策略是可接受的。

### Q5: 你的系统如何保证查询性能？
*   **回答**：
    *   **索引优化**：我们在 `media_items(title)`, `tags(tag_name)`, `storage_locations(item_id)` 等高频查询字段上建立了 B+ 树索引。
    *   **视图封装**：创建了 `v_media_library` 视图，预先写好了 JOIN 逻辑，简化应用层查询，虽然视图不直接提升性能，但保证了 SQL 逻辑的统一和优化空间。

---

## 📝 第三部分：讨论课物料清单 (Checklist)

根据《讨论课要求》，我们需要准备以下材料：

1.  **需求分析报告** (`01_需求分析报告_个人媒体资产管理系统.md`)
    *   *重点展示*：用户角色(Owner)、功能列表(MVP范围)。
2.  **E-R 图** (`ER_Diagram.html` 或 `02` 文档中的图)
    *   *重点展示*：实体关系图，特别是 `MediaItem` - `StorageLocation` 的 1:N 结构。
3.  **数据库设计文档** (`03` & `04` 文档)
    *   *重点展示*：关系模式定义、3NF 分析、SQL 建表语句。
4.  **界面原型** (`UI_Prototype.html`)
    *   *重点展示*：动态演示添加资源、文件夹管理的过程，证明设计已落地。
5.  **PPT** (需自行制作)
    *   建议结构：背景痛点 -> 解决方案(MVP) -> **数据库设计(核心)** -> 系统架构 -> 界面演示。

---

## 💡 补充：给老师的“亮点”提示

在汇报时，可以特意强调以下几点，这通常是老师喜欢的“加分项”：
1.  **“我们考虑了数据主权”**：解释为什么不用云盘，而是用本地 SQLite + P2P 同步。
2.  **“我们做了反范式的权衡（如果有）”**：虽然目前主要是 3NF，但可以提到未来如果标签查询太慢，可能会考虑反范式优化，展示批判性思维。
3.  **“我们使用了 UUID”**：解释这是为了解决分布式环境下主键冲突的问题，体现了对分布式系统的思考。