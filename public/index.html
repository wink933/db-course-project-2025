<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MediArchive Pro</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-shell">
    <aside class="side-panel">
      <div class="side-brand">
        <div class="brand-logo">MA</div>
        <div class="brand-text">
          <div class="brand-title">MediArchive</div>
          <div class="brand-subtitle">个人媒体资产管理中心</div>
        </div>
      </div>

      <section class="side-section">
        <div class="side-title">库 Library</div>
        <div id="libraryNav" class="nav-list">
          <button class="nav-item active" data-library="all">所有项目</button>
          <button class="nav-item" data-library="recent">最近添加</button>
          <button class="nav-item" data-library="web">Web 资源</button>
          <button class="nav-item" data-library="local">本地文件</button>
          <button class="nav-item" data-library="trash">回收站</button>
        </div>
      </section>

      <section class="side-section">
        <div class="side-title">文件夹 Folders</div>
        <ul id="folderList" class="tree nav-tree"></ul>
        <div class="form-row compact">
          <input id="folderNameInput" type="text" placeholder="新文件夹名称" />
          <select id="folderParentSelect"></select>
          <button id="addFolderBtn">新增</button>
        </div>
      </section>

      <section class="side-section side-section-grow">
        <div class="side-title">设备 Devices</div>
        <ul id="deviceList" class="flat nav-tree"></ul>
        <div class="form-row compact">
          <input id="deviceNameInput" type="text" placeholder="设备名称" />
          <input id="deviceTypeInput" type="text" placeholder="类型 (PC/Mobile)" />
          <button id="addDeviceBtn">新增</button>
        </div>
      </section>

      <section class="side-section">
        <div class="side-title">同步</div>
        <div class="form-row compact">
          <input id="syncEndpointInput" type="text" placeholder="对端地址，例如 http://192.168.0.5:4000" />
          <button id="syncBtn">同步元数据</button>
          <button id="refreshAvailabilityBtn" class="secondary">刷新本地可用性</button>
        </div>
        <p class="hint">提示：确保双方在同一局域网，且对端服务已启动。</p>
      </section>
    </aside>

    <main class="main-panel">
      <div class="top-toolbar">
        <div class="toolbar-search">
          <div id="breadcrumb" class="breadcrumb" aria-label="当前路径"></div>
          <div class="search-row">
            <select id="searchScope" class="scope-select" title="搜索范围">
              <option value="all">全部</option>
              <option value="currentFolder">当前文件夹</option>
              <option value="local">本地</option>
              <option value="web">网页</option>
              <option value="device">某设备</option>
            </select>
            <select id="searchScopeDevice" class="scope-device-select hidden" title="选择设备"></select>
            <span class="search-icon">🔍</span>
            <input id="searchInput" type="text" placeholder="搜索…（支持 tag:旅行 / type:Doc / device:本机 / folder:作业 / date:2025-12-01..2025-12-31）" />
          </div>
          <div id="searchChips" class="chips-row" aria-label="筛选条件"></div>
        </div>
        <div class="toolbar-actions">
          <button id="sortBtn" class="secondary toolbar-btn" type="button">排序：最新</button>
          <button id="viewToggleBtn" class="secondary toolbar-btn" type="button">视图：列表</button>
          <button id="emptyTrashBtn" class="secondary toolbar-btn hidden" type="button">清空回收站</button>
          <button id="openAddModalBtn" class="primary">+ 添加资源</button>
        </div>
      </div>

      <div id="bulkBar" class="bulk-bar hidden" aria-label="批量操作">
        <div class="bulk-left">
          <span id="bulkCount" class="bulk-count"></span>
        </div>
        <div class="bulk-actions">
          <select id="bulkFolderSelect" title="选择目标文件夹"></select>
          <button id="bulkMoveBtn" class="secondary" type="button">移动到</button>
          <input id="bulkTagsInput" type="text" placeholder="批量标签（逗号分隔）" />
          <button id="bulkTagBtn" class="secondary" type="button">添加标签</button>
          <button id="bulkUntagBtn" class="secondary" type="button">移除标签</button>
          <button id="bulkRestoreBtn" class="secondary hidden" type="button">恢复</button>
          <button id="bulkDeleteBtn" class="chip-btn danger" type="button">删除</button>
        </div>
      </div>

      <ul id="mediaList" class="resource-list"></ul>
    </main>

    <aside class="inspector-panel">
      <div id="inspectorEmpty" class="inspector-empty">
        <div class="preview-box">选择一条资源以查看详情</div>
      </div>

      <div id="inspector" class="inspector hidden">
        <div class="preview-box" id="previewBox">预览</div>

        <div class="detail-group">
          <div class="detail-label">标题</div>
          <div class="detail-row">
            <div id="detailTitle" class="detail-title"></div>
            <button id="openEditBtn" class="chip-btn">编辑</button>
            <button id="restoreBtn" class="chip-btn hidden" type="button">恢复</button>
            <button id="deleteBtn" class="chip-btn danger">删除</button>
          </div>
        </div>

        <div class="detail-group">
          <div class="detail-label">存储位置</div>
          <div id="detailLocations" class="detail-value"></div>
        </div>

        <div class="detail-group">
          <div class="detail-label">标签</div>
          <div id="detailTags" class="tag-wrap"></div>
          <div id="tagPicker" class="tag-picker"></div>
          <div class="tag-add">
            <input id="tagAddInput" type="text" placeholder="输入标签后回车" />
          </div>
        </div>

        <div class="detail-group">
          <div class="detail-label">备注</div>
          <textarea id="detailNote" class="detail-input" rows="5" placeholder="可选备注..."></textarea>
        </div>

        <div class="inspector-actions">
          <button id="openPrimaryBtn" class="primary" disabled>打开</button>
          <button id="shareBtn" class="secondary" disabled>分享</button>
        </div>
      </div>
    </aside>
  </div>

  <div id="dropOverlay" class="drop-overlay hidden">
    <div class="drop-overlay-inner">释放文件以导入</div>
  </div>

  <div id="folderContextMenu" class="context-menu hidden">
    <button data-action="rename">重命名</button>
    <button data-action="delete" class="danger">删除</button>
  </div>

  <div id="mediaContextMenu" class="context-menu hidden">
    <button data-action="open">打开</button>
    <button data-action="reveal">在资源管理器中定位</button>
    <button data-action="copyPath">复制路径</button>
    <button data-action="copyLink">复制链接</button>
    <button data-action="moveTo">移动到文件夹</button>
    <button data-action="addTags">添加标签</button>
    <button data-action="removeTags">移除标签</button>
  </div>

  <div id="addModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>添加新资源</h3>
        <button id="closeAddModal" class="modal-close">×</button>
      </div>
      <div class="modal-body">
        <div class="grid-2">
          <label>
            标题
            <input id="mediaTitleInput" type="text" />
          </label>
          <label>
            类型
            <select id="mediaTypeInput">
              <option value="Video">视频</option>
              <option value="Image">图片</option>
              <option value="Doc">文档</option>
              <option value="Web">网页</option>
            </select>
          </label>
          <label>
            文件夹
            <select id="mediaFolderInput"></select>
          </label>
          <label>
            标签 (逗号分隔)
            <input id="mediaTagsInput" type="text" />
          </label>
          <label>
            资源类型
            <select id="storageTypeInput">
              <option value="Local">本地文件</option>
              <option value="Web">网络链接</option>
            </select>
          </label>
          <label>
            路径 / URL
            <input id="mediaPathInput" type="text" />
          </label>
          <label>
            选择文件 / 拍照导入
            <input id="mediaUploadInput" type="file" accept="image/*,video/*,application/pdf" />
          </label>
          <label>
            设备
            <select id="mediaDeviceInput"></select>
          </label>
          <label>
            访问备注
            <input id="mediaAccessInput" type="text" placeholder="如需VPN/账号信息" />
          </label>
          <label class="full">
            备注
            <textarea id="mediaDescriptionInput" rows="3"></textarea>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button id="addMediaBtn">保存</button>
      </div>
    </div>
  </div>

  <div id="editModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>编辑资源</h3>
        <button id="closeEditModal" class="modal-close">×</button>
      </div>
      <div class="modal-body">
        <div class="grid-2">
          <label>
            标题
            <input id="editTitleInput" type="text" />
          </label>
          <label>
            类型
            <select id="editMediaTypeInput">
              <option value="Video">视频</option>
              <option value="Image">图片</option>
              <option value="Doc">文档</option>
              <option value="Web">网页</option>
            </select>
          </label>
          <label>
            文件夹
            <select id="editMediaFolderInput"></select>
          </label>
          <label>
            标签 (逗号分隔)
            <input id="editMediaTagsInput" type="text" />
          </label>
          <label class="full">
            备注
            <textarea id="editMediaDescriptionInput" rows="3"></textarea>
          </label>
        </div>

        <div class="subsection">
          <div class="subsection-title">为该资源新增位置（可选）</div>
          <div class="grid-2">
            <label>
              资源类型
              <select id="editStorageTypeInput">
                <option value="Local">本地文件</option>
                <option value="Web">网络链接</option>
              </select>
            </label>
            <label>
              设备
              <select id="editMediaDeviceInput"></select>
            </label>
            <label class="full">
              路径 / URL
              <input id="editMediaPathInput" type="text" placeholder="可选，留空则不新增" />
            </label>
            <label class="full">
              访问备注
              <input id="editMediaAccessInput" type="text" placeholder="如需 VPN 或账号信息" />
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="saveEditBtn">保存</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
